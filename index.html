<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
</head>

<body>
  <script src="https://p.trellocdn.com/power-up.js"></script>
  <script>
    TrelloPowerUp.initialize({



      // Start adding handlers for your capabilities here!
      'card-buttons': function (t, options) {
        return [
          {
            icon: "https://cdn.glitch.com/1b42d7fe-bda8-4af8-a6c8-eff0cea9e08a%2Frocket-ship.png?1494946700421",
            text: "Give Score",
            callback: function (t) {
              return t.popup({
                title: "Provide a Score Between 1-10",
                url: "score.html",
              });
            },
          },
        ];
      },


      'card-badges': function (t, options) {


        return t.card("id").then(function (cardID) {


          t.get("member", "shared", cardID.id)
            .then(function (score) {


              t.member("username")
                .then(function (username) {

                  console.log("HEEELLLLOOOOO");

                  return [{
                    icon: "https://cdn.glitch.com/c69415fd-f70e-4e03-b43b-98b8960cd616%2Frocket-ship-grey.png?1496162964717",
                    text: username.username,
                    //color: estimate ? null : 'red',
                  }];

                });



            })
            .then(function () {

              //t.get("member", "shared", cardID.id).then(function (score) { console.log(score); });

            });


        });





        /*
        return t.get('member', 'shared', 'estimate')
          .then(function (estimate) {
            return [{
              icon: "https://cdn.glitch.com/c69415fd-f70e-4e03-b43b-98b8960cd616%2Frocket-ship-grey.png?1496162964717",
              text: estimate || 'No Estimate!',
              color: estimate ? null : 'red',
            }];
          });
          */

      },






    });
  </script>
</body>

</html>